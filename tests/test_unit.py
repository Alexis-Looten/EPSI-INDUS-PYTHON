from application.manage_items import *

filePathJson = "One_Piece.json"
filePathCSV = "One_Piece.csv"

def test_load_file():
    jsonItems = load_file(filePathJson)
    csvItems = load_file(filePathCSV)
    
    assert len(jsonItems) > 0
    assert len(csvItems) > 0
    
def test_extract_10_random_items(mocker):
    mocker.patch(
        "application.manage_items.load_file",
        return_value=[{"Unnamed: 0": 0, "rank": "24,129", "trend": "18", "season": 1, "episode": 1, "name": "I'm Luffy! The Man Who Will Become the Pirate King!", "start": 1999, "total_votes": "647", "average_rating": 7.6}, {"Unnamed: 0": 1, "rank": "29,290", "trend": "11", "season": 1, "episode": 2, "name": "The Great Swordsman Appears! Pirate Hunter, Roronoa Zoro", "start": 1999, "total_votes": "473", "average_rating": 7.8}, {"Unnamed: 0": 2, "rank": "32,043", "trend": "7", "season": 1, "episode": 3, "name": "Morgan vs. Luffy! Who's This Beautiful Young Girl?", "start": 1999, "total_votes": "428", "average_rating": 7.7}, {"Unnamed: 0": 3, "rank": "28,818", "trend": "8", "season": 1, "episode": 4, "name": "Luffy's Past! The Red-haired Shanks Appears!", "start": 1999, "total_votes": "449", "average_rating": 8.1}, {"Unnamed: 0": 4, "rank": "37,113", "trend": "4", "season": 1, "episode": 5, "name": "Fear, Mysterious Power! Pirate Clown Captain Buggy!", "start": 1999, "total_votes": "370", "average_rating": 7.5}, {"Unnamed: 0": 5, "rank": "36,209", "trend": "4", "season": 1, "episode": 6, "name": "Desperate Situation! Beast Tamer Mohji vs. Luffy!", "start": 1999, "total_votes": "364", "average_rating": 7.7}, {"Unnamed: 0": 6, "rank": "37,648", "trend": "4", "season": 1, "episode": 7, "name": "Sozetsu Ketto! Kengo Zoro VS Kyokugei no Kabaji!", "start": 1999, "total_votes": "344", "average_rating": 7.7}, {"Unnamed: 0": 7, "rank": "38,371", "trend": "6", "season": 1, "episode": 8, "name": "Shousha wa docchi? Akuma no mi no nouryoku taiketsu!", "start": 1999, "total_votes": "335", "average_rating": 7.7}, {"Unnamed: 0": 8, "rank": "42,249", "trend": "5", "season": 1, "episode": 9, "name": "Seigi no usotsuki? Kyaputen Usoppu", "start": 2000, "total_votes": "327", "average_rating": 7.3}, {"Unnamed: 0": 9, "rank": "41,829", "trend": "4", "season": 1, "episode": 10, "name": "Chijou saikyou no hen na yatsu! Saiminjutsushi Jango", "start": 2000, "total_votes": "314", "average_rating": 7.5}, {"Unnamed: 0": 10, "rank": "43,039", "trend": "4", "season": 1, "episode": 11, "name": "Inbou o abake! Kaizoku shitsuji Kyaputen Kuro", "start": 2000, "total_votes": "310", "average_rating": 7.4}, {"Unnamed: 0": 11, "rank": "40,540", "trend": "3", "season": 1, "episode": 12, "name": "Gekitotsu! Kuroneko kaizokudan sakamichi no daikoubou!", "start": 2000, "total_votes": "303", "average_rating": 7.8}, {"Unnamed: 0": 12, "rank": "41,379", "trend": "2", "season": 1, "episode": 13, "name": "Kyoufu no futarigumi! Ny\u00e2ban kyoudai vs Zoro", "start": 2000, "total_votes": "295", "average_rating": 7.8}, {"Unnamed: 0": 13, "rank": "42,445", "trend": "2", "season": 1, "episode": 14, "name": "Rufi fukkatsu! Kaya ojousama no kesshi no taikou", "start": 2000, "total_votes": "292", "average_rating": 7.7}, {"Unnamed: 0": 14, "rank": "44,849", "trend": "2", "season": 1, "episode": 15, "name": "Kuro o taose! Otoko Usoppu namida no ketsui!", "start": 2000, "total_votes": "286", "average_rating": 7.5}]
    )
    items = load_file(filePathJson)
    chosen = extract_10_random_items(items)
    
    assert len(chosen) == 10
    
def test_pretty_show_items(mocker):
    mocker.patch(
        "application.manage_items.extract_10_random_items",
        return_value=[{'Unnamed: 0': 113, 'rank': '58,350', 'trend': '3', 'season': 1, 'episode': 114, 'name': 'Nakama no Yume ni Chikau! Kettou Mogurazuka 4-bangai', 'start': 2002, 'total_votes': '182', 'average_rating': 7.9}, {'Unnamed: 0': 712, 'rank': '75,803', 'trend': '-', 'season': 1, 'episode': 713, 'name': 'Baribari: Homage Shinken Hatsudou!', 'start': 2015, 'total_votes': '112', 'average_rating': 8.3}, {'Unnamed: 0': 892, 'rank': '51,888', 'trend': '5', 'season': 1, 'episode': 893, 'name': "Otama Appears! Luffy vs. Kaido's Army!", 'start': 2019, 'total_votes': '171', 'average_rating': 8.8}, {'Unnamed: 0': 334, 'rank': '94,070', 'trend': '-', 'season': 1, 'episode': 335, 'name': 'Shin Sekai de Matsu! Isamashiki Kaizoku to no Wakare', 'start': 2007, 'total_votes': '124', 'average_rating': 6.6}, {'Unnamed: 0': 348, 'rank': '75,320', 'trend': '-', 'season': 1, 'episode': 349, 'name': 'Luffy Kinkyuujitai! Saikyou no Kage no Ikisaki', 'start': 2008, 'total_votes': '128', 'average_rating': 7.8}, {'Unnamed: 0': 311, 'rank': '35,566', 'trend': '12', 'season': 1, 'episode': 312, 'name': 'Arigatou Merry! Yuki ni Kemuru Wakare no Umi', 'start': 2007, 'total_votes': '273', 'average_rating': 9.0}, {'Unnamed: 0': 229, 'rank': '70,434', 'trend': '1', 'season': 1, 'episode': 230, 'name': 'Suijou Toshi no Bouken! Mokushise Kyodai Zousen Koujou', 'start': 2005, 'total_votes': '146', 'average_rating': 7.7}, {'Unnamed: 0': 527, 'rank': '83,007', 'trend': '1', 'season': 1, 'episode': 528, 'name': 'Koufun Bakuhatsu! Sanji Seimei no Kiki!', 'start': 2011, 'total_votes': '122', 'average_rating': 7.4}, {'Unnamed: 0': 718, 'rank': '36,067', 'trend': '17', 'season': 1, 'episode': 719, 'name': 'Kuuchuu Kessen: Zoro Shin Hissastsu Ougi Sakuretsu!', 'start': 2015, 'total_votes': '262', 'average_rating': 9.1}, {'Unnamed: 0': 539, 'rank': '77,503', 'trend': '-', 'season': 1, 'episode': 540, 'name': 'Dorei Kaihou no Eiyuu: Boukenka Tiger', 'start': 2012, 'total_votes': '129', 'average_rating': 7.6}]
    )
    items=[{"Unnamed: 0": 0, "rank": "24,129", "trend": "18", "season": 1, "episode": 1, "name": "I'm Luffy! The Man Who Will Become the Pirate King!", "start": 1999, "total_votes": "647", "average_rating": 7.6}, {"Unnamed: 0": 1, "rank": "29,290", "trend": "11", "season": 1, "episode": 2, "name": "The Great Swordsman Appears! Pirate Hunter, Roronoa Zoro", "start": 1999, "total_votes": "473", "average_rating": 7.8}, {"Unnamed: 0": 2, "rank": "32,043", "trend": "7", "season": 1, "episode": 3, "name": "Morgan vs. Luffy! Who's This Beautiful Young Girl?", "start": 1999, "total_votes": "428", "average_rating": 7.7}, {"Unnamed: 0": 3, "rank": "28,818", "trend": "8", "season": 1, "episode": 4, "name": "Luffy's Past! The Red-haired Shanks Appears!", "start": 1999, "total_votes": "449", "average_rating": 8.1}, {"Unnamed: 0": 4, "rank": "37,113", "trend": "4", "season": 1, "episode": 5, "name": "Fear, Mysterious Power! Pirate Clown Captain Buggy!", "start": 1999, "total_votes": "370", "average_rating": 7.5}, {"Unnamed: 0": 5, "rank": "36,209", "trend": "4", "season": 1, "episode": 6, "name": "Desperate Situation! Beast Tamer Mohji vs. Luffy!", "start": 1999, "total_votes": "364", "average_rating": 7.7}, {"Unnamed: 0": 6, "rank": "37,648", "trend": "4", "season": 1, "episode": 7, "name": "Sozetsu Ketto! Kengo Zoro VS Kyokugei no Kabaji!", "start": 1999, "total_votes": "344", "average_rating": 7.7}, {"Unnamed: 0": 7, "rank": "38,371", "trend": "6", "season": 1, "episode": 8, "name": "Shousha wa docchi? Akuma no mi no nouryoku taiketsu!", "start": 1999, "total_votes": "335", "average_rating": 7.7}, {"Unnamed: 0": 8, "rank": "42,249", "trend": "5", "season": 1, "episode": 9, "name": "Seigi no usotsuki? Kyaputen Usoppu", "start": 2000, "total_votes": "327", "average_rating": 7.3}, {"Unnamed: 0": 9, "rank": "41,829", "trend": "4", "season": 1, "episode": 10, "name": "Chijou saikyou no hen na yatsu! Saiminjutsushi Jango", "start": 2000, "total_votes": "314", "average_rating": 7.5}, {"Unnamed: 0": 10, "rank": "43,039", "trend": "4", "season": 1, "episode": 11, "name": "Inbou o abake! Kaizoku shitsuji Kyaputen Kuro", "start": 2000, "total_votes": "310", "average_rating": 7.4}, {"Unnamed: 0": 11, "rank": "40,540", "trend": "3", "season": 1, "episode": 12, "name": "Gekitotsu! Kuroneko kaizokudan sakamichi no daikoubou!", "start": 2000, "total_votes": "303", "average_rating": 7.8}, {"Unnamed: 0": 12, "rank": "41,379", "trend": "2", "season": 1, "episode": 13, "name": "Kyoufu no futarigumi! Ny\u00e2ban kyoudai vs Zoro", "start": 2000, "total_votes": "295", "average_rating": 7.8}, {"Unnamed: 0": 13, "rank": "42,445", "trend": "2", "season": 1, "episode": 14, "name": "Rufi fukkatsu! Kaya ojousama no kesshi no taikou", "start": 2000, "total_votes": "292", "average_rating": 7.7}, {"Unnamed: 0": 14, "rank": "44,849", "trend": "2", "season": 1, "episode": 15, "name": "Kuro o taose! Otoko Usoppu namida no ketsui!", "start": 2000, "total_votes": "286", "average_rating": 7.5}]
    chosen = extract_10_random_items(items)
    organized_items = pretty_show_items(chosen)
    
    assert len(organized_items) > 0
    
    

    
